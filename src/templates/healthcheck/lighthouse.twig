{% extends '_layouts/cp' %}
{% import '_includes/forms' as forms %}

{% block actionButton %}
	<div
		class="buttons">
		<!-- Device Selector -->
		<div class="select">
			<select id="device-selector">
				<option value="desktop">{{ 'Desktop'|t('upsnap') }}</option>
				<option value="mobile">{{ 'Mobile'|t('upsnap') }}</option>
			</select>
		</div>
		<button type="button" class="btn submit" data-icon="refresh" id="refresh-button">
			{{ 'Refresh'|t('upsnap') }}
		</button>
	</div>
{% endblock %}

{% block content %}
	{% if success == 'warning' %}
		{% set statusClass = 'warning' %}
		{% set containerClass = 'warning' %}

		{% include 'upsnap/_components/status-container.twig' %}
	{% else %}
		{# Status container will be updated via AJAX #}
		<div id="status-container-wrapper" data-page="lighthouse">
			<div class="skeleton-card">
				<div class="skeleton-card-body">
					<div>
						<h3>
							Fetching your scores. Please hang tight as it takes around 30 seconds
							<span class="loading-dots"></span>
						</h3>
					</div>
				</div>
			</div>
			<div class="skeleton-card">
				<div class="skeleton-card-header">
					<div class="skeleton-line skeleton-line-medium"></div>
				</div>
				<div class="skeleton-card-body">
					<div class="skeleton-line skeleton-line-long"></div>
					<div class="skeleton-line skeleton-line-short"></div>
				</div>
			</div>
		</div>
		<div id="details-container-wrapper">
			<div class="skeleton-card">
				<div class="skeleton-card-header">
					<div class="skeleton-line skeleton-line-short"></div>
				</div>
				<div class="skeleton-card-body">
					<div class="skeleton-field">
						<div class="skeleton-line skeleton-line-short"></div>
						<div class="skeleton-line skeleton-line-medium"></div>
					</div>
					<div class="skeleton-field">
						<div class="skeleton-line skeleton-line-short"></div>
						<div class="skeleton-line skeleton-line-long"></div>
					</div>
					<div class="skeleton-field">
						<div class="skeleton-line skeleton-line-short"></div>
						<div class="skeleton-line skeleton-line-medium"></div>
					</div>
					<div class="skeleton-field">
						<div class="skeleton-line skeleton-line-short"></div>
						<div class="skeleton-line skeleton-line-long"></div>
					</div>
				</div>
			</div>
		</div>

		{# Hidden container for lighthouse data #}
		<div id="lighthouse-data" style="display: none;"></div>

		{# Scores Overview (hidden initially) #}
		<div
			class="scores-overview" id="scores-container" style="display: none;"><!-- Scores will be populated by JavaScript -->
		</div>

		{# Performance Metrics (hidden initially) #}
		<div
			class="performance-section" id="performance-container" style="display: none;"><!-- Performance metrics will be populated by JavaScript -->
		</div>
	{% endif %}
{% endblock %}

{% block foot %}
    <script>
        window.CraftPageData = {
            title: {{ title|json_encode|raw }},
            monitorUrl: {{ data.url|json_encode|raw }}
        };
    </script>
{% endblock %}